<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <title>ArcGIS OAuth2 Dev Utilities</title>
  </head>
  <body>
    <script>
      const parsed = {};
      function parseFromPairs(pairs) {
        pairs.forEach((pair) => {
          if (pair.indexOf('=') > -1) {
            const splitPair = pair.split('=');
            parsed[splitPair[0]] = splitPair[1];
          }
        });
      }
      const returnTime = new Date();
      const query = window.location.search;
      const hash = window.location.hash;
      parseFromPairs(query.substr(1).split('&'));
      parseFromPairs(hash.substr(1).split('&'));
      window.opener.postMessage({
        returnTime,
        query,
        hash,
        parsed,
      }, window.location.origin);
      setTimeout(() => {
        window.close();
      }, 2);
    </script>
  </body>
</html>
